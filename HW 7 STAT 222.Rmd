---
title: "STAT 222 Spring 2022 HW7"
author: "Matthew Zhao"
output:
  pdf_document: default
  html_document:
    df_print: paged
  word_document: default
header-includes: \usepackage{pdfpages}
geometry: margin = .65in
fontsize: 12pt
---

```{r echo=F}
library(knitr)
knitr::opts_chunk$set(fig.width=4, fig.height=3, message=F, warning=F, collapse=T)
options(scipen=6, digits=6)
# options(show.signif.stars = FALSE) # Show no stars for significance tests
```

```{r}
pr8.4 = read.table("http://users.stat.umn.edu/~gary/book/fcdae.data/pr8.4", header=T)
pr8.4$Time = factor(pr8.4$temp, labels = c("8hr","13hr"))
pr8.4$Airflow = factor(pr8.4$flow, labels = c("L","H"))
pr8.4$Laser = factor(pr8.4$laser, labels = c("old","new"))
```

## Q1 --- 5 points

```{r, message=FALSE}
library(mosaic)
mean(y ~ 1, data=pr8.4)
mean(y ~ Time, data=pr8.4)
mean(y ~ Airflow, data=pr8.4)
mean(y ~ Laser, data=pr8.4)
mean(y ~ Time+Airflow, data=pr8.4)
mean(y ~ Time+Laser, data=pr8.4)
mean(y ~ Airflow+Laser, data=pr8.4)
mean(y ~ Time+Airflow+Laser, data=pr8.4)
```

$\displaystyle \hat{\alpha}_{13hr} = \bar{y}_{13hr\cdot\cdot\cdot} - \bar{y}_{\cdot\cdot\cdot\cdot} = 0.19500-0.488125 = -0.293125$


$\displaystyle \hat{\beta\gamma}_{H,new} = \bar{y}_{\cdot H,new\cdot} - \bar{y}_{\cdot H\cdot\cdot}-\bar{y}_{\cdot\cdot new\cdot}+\bar{y}_{\cdot\cdot\cdot\cdot}=0.4425-0.47500- 0.47875+0.488125 = -0.023125$


$\displaystyle \hat{\alpha\beta\gamma}_{13hr,H,new} = \bar{y}_{13hr,H,new\cdot}-\bar{y}_{13hr,H\cdot\cdot}-\bar{y}_{13hr\cdot new\cdot} - \bar{y}_{\cdot H,new\cdot}+ \bar{y}_{13hr\cdot\cdot\cdot} + \bar{y}_{\cdot H\cdot\cdot} +\bar{y}_{\cdot\cdot new\cdot} - \bar{y}_{\cdot\cdot\cdot\cdot}= 0.120 -0.1725-  0.1925 - 0.4425 + 0.19500 +0.47500 + 0.47875 - 0.488125 = -0.026875$

## Q2 --- 5 points


```{r}
contrasts(pr8.4$Time) = contr.sum(2)
contrasts(pr8.4$Airflow) = contr.sum(2)
contrasts(pr8.4$Laser) = contr.sum(2)
lm1 = lm(y ~ Time*Airflow*Laser, data=pr8.4)
lm1$coef
options(digits=8) # increasing the number of digits in the output
anova(lm1)
```


$SS_{Time}=\displaystyle bcn \sum_{i=1}^{a} (\hat{\alpha}_{i})^{2} = bcn((\hat{\alpha}_{13hr})^{2} + (\hat{\alpha}_{13hr})^{2}) = 2 * 2 * 2 *($


## Q3 --- 4 points

```{r}
lm1 = lm(y ~ Time*Airflow*Laser, data=pr8.4)
anova(lm1)
lmlog = lm(log(y) ~ Time*Airflow*Laser, data=pr8.4)
anova(lmlog)
```


## Q4 --- 6 points

```{r, fig.width=5, fig.height=2.5, out.width='60%'}
par(mai=c(.6,.6,.01,.2),mgp=c(2,.6,0)) # for reducing the margin of the plot
with(pr8.4, interaction.plot(Time:Laser,Airflow,log(y), type="b"))
```



## Q5 --- 5 points


